!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function i(t,e,n,i,o,r,s){try{var l=t[r](s),a=l.value}catch(t){return void n(t)}l.done?e(a):Promise.resolve(a).then(i,o)}function o(t){return function(){var e=this,n=arguments;return new Promise(function(o,r){var s=t.apply(e,n);function l(t){i(s,o,r,l,a,"next",t)}function a(t){i(s,o,r,l,a,"throw",t)}l(void 0)})}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._$shadow=null,this._$targetModalWindow=null,this._$targetButtonPrev=null,this._$targetButtonNext=null,this._$targetModalContent=null,this._$targetCurrentElem=null,this._$selectedElem=null,this._elemIndex=parseInt(theGuide.theGuideData.elemIndex,10),this._showPrelude=null,this._tourData=null,this._observer=null,this._filteredSteps=null,this._htmlAdded=null,this._elemOldPositions=null,this.allTours=theGuide.theGuideData.allEnabledToursForThisURL,this.isActive=!1,this.currentTour=null,this.howManySteps=null,this.currentStep=null,this.controllerMethod=null}var e,n,i;return e=t,(n=[{key:"go",value:function(t,e){var n=this;this._htmlAdded||(this._addHTML(),this._$shadow=jQuery(".the-guide-shadow"),this._htmlAdded=!0),!0===this.isActive&&this.hide(),this.currentTour=parseInt(t,10),this._showPrelude=Boolean(e);var i={action:"the_guide_public_get_tour_data_by_id",nonceToken:theGuide.theGuideData.nonceTokenGetTourDataByID,id:this.currentTour};return new Promise(function(e){jQuery.post(theGuide.ajaxurl,i,function(i){n._tourData=i,n._filteredSteps=[];for(var o=0;o<n._tourData.steps.length;++o)jQuery(n._tourData.steps[o]).length&&n._filteredSteps.push(n._tourData.steps[o]);var r=localStorage.getItem("theGuide")?JSON.parse(localStorage.getItem("theGuide")):{};t in r&&r[t]?n.currentStep=r[t]:n.currentStep=n._elemIndex+1,n.howManySteps=n._filteredSteps.length,e(0)},"json")})}},{key:"show",value:function(){this._filteredSteps.length&&(this._showPrelude?this._useSelectedActivationMethod():this._initEverything())}},{key:"_addHTML",value:function(){var t='\n<div id="the-guide">\n    <div class="the-guide-floating-block" style="display: none">\n        <div class="the-guide-floating-block-container">\n            <div class="the-guide-floating-block-content"></div>\n            <div class="the-guide-floating-block-button-container">\n                <input class="the-guide-floating-block-button" type="button" value="'.concat(theGuide.translates.start,'" >\n            </div>\n        </div>\n    </div>\n    \n    \n    <div id="the-guide-modal-floating" class="the-guide-modal" style="display: none">\n        <div class="the-guide-modal-floating-container">\n            <div class="the-guide-modal-floating-current-elem"></div>\n            <div class="the-guide-modal-floating-content"></div>\n            <div class="the-guide-modal-floating-buttons">\n                <input id="the-guide-modal-floating-button-prev" type="button" name="" value="').concat(theGuide.translates.previous,'">\n                <input id="the-guide-modal-floating-button-next" type="button" name="" value="').concat(theGuide.translates.next,'">\n            </div>\n        </div>\n    </div>\n    \n    \n    <div id="the-guide-modal-next-to-the-elem" class="the-guide-modal" style="display: none">\n        <div class="the-guide-modal-next-to-the-elem-container">\n    \n            <div class="the-guide-modal-next-to-the-elem-button-prev-container">\n                <input id="the-guide-modal-next-to-the-elem-button-prev" type="button" name="" value="').concat(theGuide.translates.previous,'">\n            </div>\n    \n            <div class="the-guide-modal-next-to-the-elem-current-elem"></div>\n    \n            <div class="the-guide-modal-next-to-the-elem-content"></div>\n    \n            <div class="the-guide-modal-next-to-the-elem-button-next-container">\n                <input id="the-guide-modal-next-to-the-elem-button-next" type="button" name="" value="').concat(theGuide.translates.next,'">\n            </div>\n    \n        </div>\n    </div>\n    \n    \n    <div class="the-guide-shadow" style="display: none"></div>\n</div>    \n');jQuery("body").append(t)}},{key:"_useSelectedActivationMethod",value:function(){var t=this,e=this,n=this._tourData.activationMethodAndItsData;if("on-load"===n.method)this._initEverything();else if("floating"===n.method){var i=jQuery(".the-guide-floating-block"),o=jQuery(".the-guide-floating-block-content"),r={};n.position&&(n.position.top&&(r.top=n.position.top,r.bottom="auto"),n.position.bottom&&(r.bottom=n.position.bottom,r.top="auto"),n.position.left&&(r.left=n.position.left,r.right="auto"),n.position.right&&(r.right=n.position.right,r.left="auto")),i.css(r),n.floatingText&&o.text(n.floatingText),i.draggable().show(),jQuery(".the-guide-floating-block-button").click(function(e){e.stopPropagation(),t._initEverything(),i.hide()})}else if("on-click"===n.method){var s=function t(n){n.stopPropagation(),n.preventDefault(),n.target.blur(),jQuery("*").off("click",t),e._initEverything()};n.selectors.forEach(function(t){jQuery(t).on("click",event,s)})}}},{key:"_initEverything",value:function(){this.isActive=!0,this._initController(),this._addListeners(),this.goToTheStep(this.currentStep)}},{key:"_initController",value:function(){var t=this._tourData.controllerMethodAndItsData;if("floating"===t.method){this.controllerMethod="floating",this._$targetModalWindow=jQuery("#the-guide-modal-floating"),this._$targetButtonPrev=jQuery("#the-guide-modal-floating-button-prev"),this._$targetButtonNext=jQuery("#the-guide-modal-floating-button-next"),this._$targetModalContent=jQuery(".the-guide-modal-floating-content"),this._$targetCurrentElem=jQuery(".the-guide-modal-floating-current-elem");var e={};t.position&&(t.position.top&&(e.top=t.position.top,e.bottom="auto"),t.position.bottom&&(e.bottom=t.position.bottom,e.top="auto"),t.position.left&&(e.left=t.position.left,e.right="auto"),t.position.right&&(e.right=t.position.right,e.left="auto")),this._$targetModalWindow.css(e),this._$targetModalWindow.draggable().show()}else"next-to-the-selected-elem"===t.method&&(this.controllerMethod="next-to",this._$targetModalWindow=jQuery("#the-guide-modal-next-to-the-elem"),this._$targetButtonPrev=jQuery("#the-guide-modal-next-to-the-elem-button-prev"),this._$targetButtonNext=jQuery("#the-guide-modal-next-to-the-elem-button-next"),this._$targetModalContent=jQuery(".the-guide-modal-next-to-the-elem-content"),this._$targetCurrentElem=jQuery(".the-guide-modal-next-to-the-elem-current-elem"),this._$targetModalWindow.show())}},{key:"_addListeners",value:function(){var t,e=this,n=this;this.handleButtonPrev=function(){n.goToTheStep(n.currentStep-1)},this._$targetButtonPrev.on("click",this.handleButtonPrev),this.handleButtonNext=function(){n.goToTheStep(n.currentStep+1)},this._$targetButtonNext.on("click",this.handleButtonNext),this.handleClickOutsideModal=function(t){jQuery(t.target).closest(n._$targetModalWindow).length||n.hide()},jQuery(document).on("click",event,this.handleClickOutsideModal),this.handleKeydown=function(t){37===t.which?n._$targetButtonPrev.click():39===t.which?n._$targetButtonNext.click():27===t.which&&n.hide()},jQuery(document).on("keydown",event,this.handleKeydown),this._observer||(this._observer=new MutationObserver(function(t){e._reposfElemPosChanged()}),this._observer.observe(document.body,{childList:!0,attributes:!0,characterData:!0,subtree:!0})),jQuery(window).resize(function(){clearTimeout(t),t=setTimeout(e._reposfElemPosChanged.bind(e),500)})}},{key:"_setShadowAndScroll",value:function(){if(this.isActive){this._$selectedElem=jQuery(this._filteredSteps[this._elemIndex]);var t=this._$selectedElem.innerWidth(),e=this._$selectedElem.innerHeight(),n=this._$selectedElem.offset();this._elemOldPositions="w"+t+"h"+e+"ot"+n.top+"ol"+n.left,this._makePositioning(),this._print()}}},{key:"_reposfElemPosChanged",value:function(){var t=this._$selectedElem.innerWidth(),e=this._$selectedElem.innerHeight(),n=this._$selectedElem.offset(),i="w"+t+"h"+e+"ot"+n.top+"ol"+n.left;this._elemOldPositions!==i&&(this._elemOldPositions=i,this._makePositioning())}},{key:"_makePositioning",value:function(){var t=jQuery("html, body"),e=this._$selectedElem.innerWidth(),n=this._$selectedElem.innerHeight(),i=this._$selectedElem.offset();this._$shadow.show().css({width:e,height:n,left:i.left,top:i.top}),this._moveTheTourControllerToTheElement(),t.stop(),t.animate({scrollTop:i.top-jQuery(window).height()/2})}},{key:"_moveTheTourControllerToTheElement",value:function(){if("next-to"===this.controllerMethod){var t=this._$selectedElem.offset(),e=this._$targetModalWindow.outerHeight(),n=this._$selectedElem.outerHeight(),i=t.top-e-10;i<e+20&&(i=t.top+n+10);var o=this._$targetModalWindow.outerWidth()/2,r=this._$selectedElem.outerWidth()/2,s=t.left+r-o;s<this._$targetModalWindow.outerWidth()&&(s=10),this._$targetModalWindow.css({top:i,left:s})}}},{key:"_print",value:function(){this._$targetCurrentElem.text(this.currentStep+"/"+this._filteredSteps.length),this._$targetModalContent.text(this._tourData.stepsContent[this._elemIndex])}},{key:"hide",value:function(){this.isActive=!1,this._observer.disconnect(),this._observer=null,this._$targetButtonPrev.off("click",this.handleButtonPrev),this._$targetButtonNext.off("click",this.handleButtonNext),jQuery(document).off("click",this.handleClickOutsideModal),jQuery(document).off("keydown",this.handleKeydown),this._$shadow.css({display:"none"}),this._$targetModalWindow.css({display:"none"})}},{key:"getStepSelector",value:function(t){return this._tourData.steps[t-1]}},{key:"getStepContent",value:function(t){return this._tourData.stepsContent[t-1]}},{key:"setStepSelector",value:function(t,e){return this._filteredSteps[t-1]=e,this.currentStep===t&&this._setShadowAndScroll(),0}},{key:"setStepContent",value:function(t,e){return this._tourData.stepsContent[t-1]=e,this.currentStep===t&&this._print(),0}},{key:"goToTheStep",value:function(t){if(this._elemIndex=t-1,this.currentStep=t,this.currentStep<1&&(this._elemIndex=0,this.currentStep=1),this.currentStep===this.howManySteps-1&&this._$targetButtonNext.val(theGuide.translates.next),this.currentStep===this.howManySteps&&this._$targetButtonNext.val(theGuide.translates.finish),this.currentStep>this.howManySteps){var e=this.currentTour,n=localStorage.getItem("theGuide")?JSON.parse(localStorage.getItem("theGuide")):{},i=r({},e,"-1");return localStorage.setItem("theGuide",JSON.stringify(Object.assign(n,i))),this.hide(),0}var o=this.currentTour,s=localStorage.getItem("theGuide")?JSON.parse(localStorage.getItem("theGuide")):{},l=r({},o,this.currentStep);return localStorage.setItem("theGuide",JSON.stringify(Object.assign(s,l))),this._setShadowAndScroll(),0}}])&&s(e.prototype,n),i&&s(e,i),t}();jQuery(function(){function t(t){return e.apply(this,arguments)}function e(){return(e=o(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.TheGuideInst.go(e,!0);case 2:0===t.sent&&window.TheGuideInst.show();case 4:case"end":return t.stop()}},t)}))).apply(this,arguments)}!function(){var e=o(regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(t){var e={action:"the_guide_public_init",url:window.location.href};jQuery.post(theGuide.ajaxurl,e,function(e){e&&(theGuide.theGuideData=e,t(0))},"json")});case 2:0===e.sent&&(n=theGuide.theGuideData.TourID,i=localStorage.getItem("theGuide")?JSON.parse(localStorage.getItem("theGuide")):{},n in i&&"-1"===i[n]||(window.TheGuideInst=new l,t(n),theGuide_loadCustomCSS()));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()})}]);